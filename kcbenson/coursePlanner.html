<html>
	<head>
		<script>
			
			<!-- javascript solution: creates new elements with attributes -->
			var xmlhttp = new XMLHttpRequest();
			var url1 = "https://api.svsu.edu/courses?prefix=CS";
			var url2 = "https://api.svsu.edu/courses?prefix=CIS";
			var url3 = "https://api.svsu.edu/courses?prefix=MATH";
			var url4 = "https://api.svsu.edu/courses?prefix=RPW&courseNumber=304";
			var url5 = "https://api.svsu.edu/courses?prefix=COMM&courseNumber=105A";

			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
					var myArr = JSON.parse(xmlhttp.responseText);
					myFunction(myArr);
				}
			};
			//gets the courses to populate the dropdown list
			xmlhttp.open("GET", url1, true);
			xmlhttp.send();
			xmlhttp.open("GET", url2, true);
			xmlhttp.send();
			xmlhttp.open("GET", url3, true);
			xmlhttp.send();
			xmlhttp.open("GET", url4, true);
			xmlhttp.send();
			xmlhttp.open("GET", url5, true);
			xmlhttp.send();

			function myFunction(arr) {
				var out = "";
				var i;
				for(i = 0; i < arr.courses.length; i++) {
					var newP = document.createElement("option");
					newP.setAttribute("value", i);
					var newText 
						= document.createTextNode(arr.courses[i].prefix + " " 
						+ arr.courses[i].courseNumber + " " 
						+ arr.courses[i].term + " " 
						+ arr.courses[i].meetingTimes[0].days + " " 
						+ arr.courses[i].meetingTimes[0].startTime + " " 
						+ arr.courses[i].meetingTimes[0].instructor); 
					document.getElementById("id02").appendChild(newP);
					newP.appendChild(newText);
					// out += arr.courses[i].prefix + " " + arr.courses[i].courseNumber + "<br />";
				}
				// document.getElementById("id01").innerHTML = out;
			}
			
		</script>
	</head>
	<body>
		<h1> Program 02 - Course Planner </h1>
		<table border="1">
			<tr>
				<td>
					<h2>Courses Taken</h2>
					<p>Enter courses separated by commas: CS 105, CIS 255, ...</p>
					<input type="text"><br />
					<button type='submit' value='Submit'>Submit</button>
				</td>
				<td>
					<h2>Courses for Degree</h2>
					<form action="">
						<input id="cscourses" type="radio" name="degree" value="cs" checked="checked" onchange="major()";>CS</input><br />
						<input id="ciscourses" type="radio" name="degree" value="cis" onchange="major()";>CIS</input><br />
					</form>
					<p>Edit if desired</p>
					<textarea id="allCoursesNeeded" rows="10" cols="50">
						
					</textarea>
				</td>
			</tr>
			<tr>
				<td>
					<h2>Courses Available for Registration</h2>
				</td>
				<td>
					<h2>Courses Not Yet Available</h2>
				</td>
			</tr>
		</table>
		<p id="id01"></p>
		<select id="id02"></select>
		<script>
			//courses for CS
			var cscourses = ["CS 105", "CS 116", "CS 216", "CS 245", "CS 146",
				"CS 316", "CS 331", "CS 401", "CS 411", "CS 421", "CS 446", "CS 451", "CS 461",
				"CS 471", "CS 345", "CS 403", "CS 431", "CS 476", "CS 482", "CS 490",
				"CIS 255","CIS 355", "CIS 357", "CIS 311", "COMM 105A", 
				"RPW 304", "PHIL 210B","MATH 161","MATH 223","MATH 300"];
			//courses for CIS
			var ciscourses = ["CS 245", "CIS 255", "CIS 301", "CIS 311","CIS 333",
				"CIS 355", "CIS 366", "CIS 386", "CIS 422","CIS 357", "CIS 371", 
				"CIS 425", "CIS 486", "CIS 490","CS 105", "CS 116", "CS 146", "CS 216", 
				"CS 345","ECON 221", "LAW 308", "MGT 321", "MKT 331", "PHIL 210B",
				"MATH 120B", "COMM 105A", "RPW 304", "ACCT 213"];
			// prerequisite list			
			var prereqs = [
				{course: "CS 105", prereq1: "", prereq2: ""},
				{course: "CS 116", prereq1: "CS 105", prereq2: ""},
				{course: "CS 216", prereq1: "CS 116", prereq2: "MATH 140"},
				{course: "CS 245", prereq1: "CS 116", prereq2: "MATH 140"},
				{course: "CS 146", prereq1: "", prereq2: ""},
				{course: "CS 316", prereq1: "CS 216", prereq2: "MATH 300"},
				{course: "CS 331", prereq1: "CS 105", prereq2: ""},
				{course: "CS 401", prereq1: "CS 105", prereq2: ""},
				{course: "CS 411", prereq1: "CS 105", prereq2: ""},
				{course: "CS 421", prereq1: "CS 105", prereq2: ""},
				{course: "CS 446", prereq1: "CS 105", prereq2: ""},
				{course: "CS 451", prereq1: "CS 105", prereq2: ""},
				{course: "CS 461", prereq1: "CS 105", prereq2: ""},
				{course: "CS 471", prereq1: "CS 105", prereq2: ""},
				{course: "CS 345", prereq1: "CS 105", prereq2: ""},
				{course: "CS 403", prereq1: "CS 105", prereq2: ""},
				{course: "CS 431", prereq1: "CS 105", prereq2: ""},
				{course: "CS 476", prereq1: "CS 105", prereq2: ""},
				{course: "CS 482", prereq1: "CS 105", prereq2: ""},
				{course: "CS 490", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 255", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 355", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 357", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 311", prereq1: "CS 105", prereq2: ""},
				{course: "COMM 105A", prereq1: "CS 105", prereq2: ""},
				{course: "RPW 304", prereq1: "CS 105", prereq2: ""},
				{course: "PHIL 210B", prereq1: "CS 105", prereq2: ""},
				{course: "MATH 161", prereq1: "CS 105", prereq2: ""},
				{course: "MATH 223", prereq1: "CS 105", prereq2: ""},
				{course: "MATH 300", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 301", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 333", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 366", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 422", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 371", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 425", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 486", prereq1: "CS 105", prereq2: ""},
				{course: "CIS 490", prereq1: "CS 105", prereq2: ""},
			
			];
			
			// courses taken - need to pull from text input
			var taken = "CS 105";
			
			function prereqTaken (course) {
				var retval = true;
				for (var i=0; i <prereqs.length; i++) {
					//look for courses with prereqs
					if(prereqs[i].course == course) {
						//check if prereq is in the taken courses list
						if (taken.indexOf(prereqs[i].prereq1) == -1 
							|| (taken.indexOf(prereqs[i].prereq2) == -1
							&& taken.indexOf(prereqs[i].prereq2 !=""))){
							retval = false;
							break;
						}
					}
				}
				return retval;
			};
			
			console.log(prereqTaken("CS 116"));
			
			//insert CS courses into textarea (id="allCoursesNeeded")
			function major(){
					
				var allCourses = document.getElementById("allCoursesNeeded");
				var allCoursesText = "";
			
				if(document.getElementById("cscourses").checked){
					for(var i = 0; i < cscourses.length; i++) 
					allCoursesText += cscourses[i] + ", ";
					allCourses.innerHTML = allCoursesText;
				}
				if(document.getElementById("ciscourses").checked){
					for(var i = 0; i < ciscourses.length; i++) 
					allCoursesText += ciscourses[i] + ", ";
					allCourses.innerHTML = allCoursesText;
				}
			};
		</script>
	</body>
</html>